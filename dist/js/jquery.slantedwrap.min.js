jQuery.fn.reverse=[].reverse,jQuery.fn.slantedwrap=function(){var a=this;$.fn.slantedwrap.init=function(){a.each(function(){var a=$(this).find(".slantedwrap-overlay").height(),b=$(this).find(".slantedwrap-overlay").width(),c=$('<canvas height="'+a+'" width="'+b+'" />');$(this).find(".slantedwrap-overlay").append(c),$(this).find(".slantedwrap-content").hide()}),$(window).resize(function(){$.fn.slantedwrap.draw()}),$.fn.slantedwrap.draw()},$.fn.slantedwrap.draw=function(){a.each(function(){var a=$(this).data("halign")||"left",b=$(this).data("valign")||"top",c=$(this).data("wrapstart")||1,d=$(this).data("wrappadding")||16,e=$(this).find(".slantedwrap-overlay").height(),f=$(this).find(".slantedwrap-overlay").width(),g=e/(c*f-2*d),h=$(this).find("canvas");h.attr("height",e),h.attr("width",f);var i=h[0].getContext("2d");i.clearRect(0,0,f,e),i.globalAlpha=.2,i.fillStyle="#000000",i.beginPath(),"left"===a?(i.moveTo(0,"top"===b?0:e),i.lineTo(c*f,"top"===b?0:e),i.lineTo(0,"top"===b?e:0)):(i.moveTo(f,"top"===b?0:e),i.lineTo((1-c)*f,"top"===b?0:e),i.lineTo(f,"top"===b?e:0)),i.closePath(),i.fill(),i.globalAlpha=1;var j=8,k="left"===a?j:f-j,l=e/g;if("top"===b){var m=0;$(this).find(".slantedwrap-content h3, .slantedwrap-content p").each(function(){i.fillStyle=$(this).css("color"),i.font=$(this).css("font-size")+" "+$(this).css("font-family"),i.textAlign=a;var b=1.2*parseFloat($(this).css("font-size"));m+=b,l=(e-m)/g;for(var c=$(this).text(),d=c.split(" "),f="",h=0;h<d.length;h++){var j=f+d[h]+" ",n=i.measureText(j),o=n.width;o>l&&h>0?(i.fillText(f,k,m),f=d[h]+" ",m+=b,l=(e-m)/g):f=j}i.fillText(f,k,m),m+=8})}else{var m=e;$(this).find(".slantedwrap-content h3, .slantedwrap-content p").reverse().each(function(){i.fillStyle=$(this).css("color"),i.font=$(this).css("font-size")+" "+$(this).css("font-family"),i.textAlign=a;var b=1.2*parseFloat($(this).css("font-size"));m-=b,l=m/g;for(var c=$(this).text(),d=c.split(" "),e="",f=d.length-1;f>=0;f--){var h=d[f]+(e.length?" "+e:""),j=i.measureText(h),n=j.width;n>l&&f!==d.length-1?(i.fillText(e,k,m),e=d[f],m-=b,l=m/g):e=h}i.fillText(e,k,m)})}})},$.fn.slantedwrap.init()};