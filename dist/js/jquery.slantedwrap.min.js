String.prototype.unquoted=function(){return this.replace(/(^("|'))|(("|')$)/g,"")},function(a){a.fn.detectFont=function(){var b=a(this).css("font-family").split(",");if(1===b.length)return b[0].unquoted();var c=a("<div />");a("body").append(c),c.css({clear:"both",display:"inline-block","font-family":a(this).css("font-family"),"font-size":a(this).css("font-size"),"font-weight":a(this).css("font-weight"),"white-space":"nowrap"}).html(a(this).html());var d=null;for(var e in b){var f=c.clone().css({visibility:"visible","font-family":b[e].unquoted()}).appendTo("body");if(c.width()===f.width()){f.remove(),d=b[e].unquoted();break}f.remove()}return c.remove(),d}}(jQuery),jQuery.fn.reverse=[].reverse,jQuery.fn.slantedwrap=function(){var a=this;$.fn.slantedwrap.init=function(){a.each(function(){var a=$(this).find(".slantedwrap-overlay").height(),b=$(this).find(".slantedwrap-overlay").width(),c=$('<canvas height="'+a+'" width="'+b+'" />');$(this).find(".slantedwrap-overlay").append(c)}),$(window).resize(function(){$.fn.slantedwrap.draw()}),$.fn.slantedwrap.draw()},$.fn.slantedwrap.draw=function(){a.each(function(){var a=$(this).data("breakpoint")||768,b=$(this).data("halign")||"left",c=$(this).data("valign")||"top",d=$(this).data("wrapstart")||1,e=$(this).data("wrappadding")||16,f=$(this).find(".slantedwrap-overlay").width();if(a>f)$(this).find(".slantedwrap-content").show(),$(this).find("canvas").hide();else{$(this).find(".slantedwrap-content").hide(),$(this).find("canvas").show();var g=$(this).find(".slantedwrap-overlay").height(),h=g/(d*f-2*e),i=$(this).find("canvas");i.attr("height",g),i.attr("width",f);var j=i[0].getContext("2d");j.clearRect(0,0,f,g),j.globalAlpha=.2,j.fillStyle="#000000",j.beginPath(),"left"===b?(j.moveTo(0,"top"===c?0:g),j.lineTo(d*f,"top"===c?0:g),j.lineTo(0,"top"===c?g:0)):(j.moveTo(f,"top"===c?0:g),j.lineTo((1-d)*f,"top"===c?0:g),j.lineTo(f,"top"===c?g:0)),j.closePath(),j.fill(),j.globalAlpha=1;var k=8,l="left"===b?k:f-k,m=g/h;if("top"===c){var n=0;$(this).find(".slantedwrap-content h3, .slantedwrap-content p").each(function(){j.fillStyle=$(this).css("color"),j.font=$(this).css("font-size")+" "+$(this).detectFont(),j.textAlign=b;var a=1.2*parseFloat($(this).css("font-size"));n+=a,m=(g-n)/h;for(var c=$(this).text().trim(),d=c.split(" "),e="",f=0;f<d.length;f++){var i=(e?e+" ":"")+d[f],k=j.measureText(i),o=k.width;if(o>m&&f>0){if(-1===e.indexOf(" ")&&f!==d.length-1){j.fillText(String.fromCharCode(8230),l,n+a);break}j.fillText(e,l,n),e=d[f],n+=a,m=(g-n)/h}else e=i}j.fillText(e,l,n),n+=8})}else{var n=g;$(this).find(".slantedwrap-content h3, .slantedwrap-content p").reverse().each(function(){j.fillStyle=$(this).css("color"),j.font=$(this).css("font-size")+" "+$(this).css("font-family"),j.textAlign=b;var a=1.2*parseFloat($(this).css("font-size"));n-=a,m=n/h;for(var c=$(this).text(),d=c.split(" "),e="",f=d.length-1;f>=0;f--){var g=d[f]+(e.length?" "+e:""),i=j.measureText(g),k=i.width;k>m&&f!==d.length-1?(j.fillText(e,l,n),e=d[f],n-=a,m=n/h):e=g}j.fillText(e,l,n)})}}})},$.fn.slantedwrap.init()};