!function(a){console.info("TEST MODE"),a.fn.reverse=[].reverse,a.fn.slantedwrap=function(){var b=this;a.fn.slantedwrap.init=function(){b.each(function(){if(!a(this).find("canvas").length){var b=a(this).find(".slantedwrap-overlay").height(),c=a(this).find(".slantedwrap-overlay").width(),d=a('<canvas height="'+b+'" width="'+c+'" />');a(this).find(".slantedwrap-overlay").append(d)}}),a(window).resize(function(){a.fn.slantedwrap.draw()}),a.fn.slantedwrap.draw()},a.fn.slantedwrap.draw=function(){b.each(function(){var b=a(this).data("breakpoint")||768,c=a(this).data("halign")||"left",d=a(this).data("offset")||.1,e=a(this).data("valign")||"top",f=a(this).data("wrapstart")||1,g=a(this).data("wrappadding")||16,h=a(this).find(".slantedwrap-overlay").width();if(b>h)a(this).find(".slantedwrap-content h3, .slantedwrap-content p").show(),a(this).find(".slantedwrap-content p.aftercontent").css("text-align","left").css("margin-top",0),a(this).find("canvas").hide();else{a(this).find(".slantedwrap-content h3, .slantedwrap-content p:not(.aftercontent)").hide(),a(this).find("canvas").show();var i=a(this).find(".slantedwrap-overlay").height(),j=i/(f*h-2*g),k=a(this).find("canvas");k.attr("height",i),k.attr("width",h);var l=k[0].getContext("2d");l.clearRect(0,0,h,i),l.globalAlpha=.2,l.fillStyle="#000000",l.beginPath(),"left"===c?(l.moveTo(0,"top"===e?0:i),l.lineTo(f*h,"top"===e?0:i),l.lineTo(h*d,"top"===e?i:0),l.lineTo(0,"top"===e?i:0),l.lineTo(0,"top"===e?0:i)):(l.moveTo(h,"top"===e?0:i),l.lineTo((1-f)*h,"top"===e?0:i),l.lineTo(h*(1-d),"top"===e?i:0),l.lineTo(h,"top"===e?i:0),l.lineTo(h,"top"===e?0:i)),l.closePath(),l.fill(),l.globalAlpha=1;var m=8,n="left"===c?m:h-m,o=i/j;if("top"===e){var p=0;a(this).find(".slantedwrap-content h3, .slantedwrap-content p:not(.aftercontent)").each(function(){l.fillStyle=a(this).css("color"),l.font=a(this).css("font-size")+" "+a(this).detectFont(),l.textAlign=c;var b=1.2*parseFloat(a(this).css("font-size"));p+=b,o=(i-p)/j;for(var d=a(this).text().trim(),e=d.split(" "),f="",g=0;g<e.length;g++){var h=(f?f+" ":"")+e[g],k=l.measureText(h),m=k.width;if(m>o&&g>0){if(-1===f.indexOf(" ")&&g!==e.length-1){l.fillText(String.fromCharCode(8230),n,p+b);break}l.fillText(f,n,p),f=e[g],p+=b,o=(i-p)/j}else f=h}l.fillText(f,n,p),p+=8}),a(this).find(".slantedwrap-content p.aftercontent").length&&a(this).find(".slantedwrap-content p.aftercontent").css("text-align",c).css("margin-top",p+16+"px")}else{var p=i;a(this).find(".slantedwrap-content h3, .slantedwrap-content p").reverse().each(function(){l.fillStyle=a(this).css("color"),l.font=a(this).css("font-size")+" "+a(this).detectFont(),l.textAlign=c;var b=1.2*parseFloat(a(this).css("font-size"));p-=b,o=p/j;for(var d=a(this).text(),e=d.split(" "),f="",g=e.length-1;g>=0;g--){var h=e[g]+(f.length?" "+f:""),i=l.measureText(h),k=i.width;k>o&&g!==e.length-1?(l.fillText(f,n,p),f=e[g],p-=b,o=p/j):f=h}l.fillText(f,n,p)})}}})},a.fn.slantedwrap.init()}}(jQuery);