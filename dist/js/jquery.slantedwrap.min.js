!function(a){a.fn.reverse=[].reverse;var b="transparent";a.fn.slantedwrap=function(){var c=this;a.fn.slantedwrap.init=function(){c.each(function(){if(!a(this).find("canvas").length){b=a(this).find(".slantedwrap-overlay").css("background-color");var c=a(this).find(".slantedwrap-overlay").height(),d=a(this).find(".slantedwrap-overlay").width(),e=a('<canvas height="'+c+'" width="'+d+'" />');a(this).find(".slantedwrap-overlay").append(e)}}),a(window).resize(function(){a.fn.slantedwrap.draw()}),a.fn.slantedwrap.draw()},a.fn.slantedwrap.draw=function(){c.each(function(){var c=a(this).data("breakpoint")||768,d=a(this).data("halign")||"left",e=a(this).data("offset")||.1,f=a(this).data("valign")||"top",g=a(this).data("wrapstart")||1,h=a(this).data("wrappadding")||16,i=a(this).find(".slantedwrap-overlay").width();if(c>i)a(this).find(".slantedwrap-overlay").css("background-color",b),a(this).find(".slantedwrap-content h3, .slantedwrap-content p").show(),a(this).find(".slantedwrap-content p.aftercontent").css("text-align","left").css("margin-top",0),a(this).find("canvas").hide();else{a(this).find(".slantedwrap-overlay").css("background-color","transparent"),a(this).find(".slantedwrap-content h3, .slantedwrap-content p:not(.aftercontent)").hide(),a(this).find("canvas").show();var j=a(this).find(".slantedwrap-overlay").height(),k=j/(g*i-2*h),l=a(this).find("canvas");l.attr("height",j),l.attr("width",i);var m=l[0].getContext("2d");m.clearRect(0,0,i,j),m.globalAlpha=.2,m.fillStyle="#000000",m.beginPath(),"left"===d?(m.moveTo(0,"top"===f?0:j),m.lineTo(g*i,"top"===f?0:j),m.lineTo(i*e,"top"===f?j:0),m.lineTo(0,"top"===f?j:0),m.lineTo(0,"top"===f?0:j)):(m.moveTo(i,"top"===f?0:j),m.lineTo((1-g)*i,"top"===f?0:j),m.lineTo(i*(1-e),"top"===f?j:0),m.lineTo(i,"top"===f?j:0),m.lineTo(i,"top"===f?0:j)),m.closePath(),m.fill(),m.globalAlpha=1;var n=8,o="left"===d?n:i-n,p=j/k;if("top"===f){var q=0;a(this).find(".slantedwrap-content h3, .slantedwrap-content p:not(.aftercontent)").each(function(){m.fillStyle=a(this).css("color"),m.font=a(this).css("font-size")+" "+a(this).detectFont(),m.textAlign=d;var b=1.2*parseFloat(a(this).css("font-size"));q+=b,p=(j-q)/k;for(var c=a(this).text().trim(),e=c.split(" "),f="",g=0;g<e.length;g++){var h=(f?f+" ":"")+e[g],i=m.measureText(h),l=i.width;if(l>p&&g>0){if(-1===f.indexOf(" ")&&g!==e.length-1){m.fillText(String.fromCharCode(8230),o,q+b);break}m.fillText(f,o,q),f=e[g],q+=b,p=(j-q)/k}else f=h}m.fillText(f,o,q),q+=8}),a(this).find(".slantedwrap-content p.aftercontent").length&&a(this).find(".slantedwrap-content p.aftercontent").css("text-align",d).css("margin-top",q+16+"px")}else{var q=j;a(this).find(".slantedwrap-content h3, .slantedwrap-content p").reverse().each(function(){m.fillStyle=a(this).css("color"),m.font=a(this).css("font-size")+" "+a(this).detectFont(),m.textAlign=d;var b=1.2*parseFloat(a(this).css("font-size"));q-=b,p=q/k;for(var c=a(this).text(),e=c.split(" "),f="",g=e.length-1;g>=0;g--){var h=e[g]+(f.length?" "+f:""),i=m.measureText(h),j=i.width;j>p&&g!==e.length-1?(m.fillText(f,o,q),f=e[g],q-=b,p=q/k):f=h}m.fillText(f,o,q)})}}})},a.fn.slantedwrap.init()}}(jQuery);